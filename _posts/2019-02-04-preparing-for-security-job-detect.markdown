---
layout: default
title: "Prepairing for that first security job - Detect"
date: 2019-02-04 07:34:42 -0500
categories: uncategorized
---

As the last post concluded, as security professionals we have to allow openness in our security controls to allow the organization to function and be successful. For example, HR data would be more secure if no one could access it but then it also wouldn’t be that useful to the HR department. We address the risk that comes with that openness by monitoring the environment for unauthorized activity.

**Awareness**

One of the great things about security is the constantly changing landscape. For example, 2017 to 2018 saw a shift of attackers utilizing coin mining payloads over ransomware. By design, coin mining tries to go unnoticed while ransomware requires the attack to be in the user’s face if the attacker wants to get paid. This means there are different indicators of compromise to look out for.

Each individual will have to determine a method that works for them to keep up with the threat landscape. A few of the resources I use are:

* Podcasts such as Security Now, Defensive Security, The Cyberwire, and the SANS Internet Storm Center podcast. The SANS podcast is different than the first two in that the episodes are shorter but come out nearly every day Monday through Friday.
* Blogs and websites such as Krebs on Security, US-CERT, and Slashdot
* Twitter. As crazy as it might sound, Twitter is big in the infosec space.
* Email newsletters such as those from SANS

As you hear of new threats, ask yourself how or if they apply to the environment you’re working in and how you might go about detecting them.

**Detecting Incidents** 

Of course the biggest component of detecting incidents is going to be analyzing logs with a SIEM. If you experimented with the tools discussed in the last post you may have noticed that many of them produce logs describing the activity of the environment. I can’t recommend enough that you download the free 500MB trial of Splunk and start analyzing logs.

Even if you don’t want to setup a SIEM, consider the system you’re using right now. Do you know how to find out if someone has tried to login to it while you were gone? What about incoming or outgoing network activity?

The challenge of detecting an incident is sifting through Gigabytes or even Terrabytes of log data to identify the entries that are of a concern. In addition to a SIEM,  you’re going to have to know what you’re looking for. Events that may indicate an incident are known as Indicators of Compromise. Think of the environment you’re protecting, what you’ve learned as far as your threat awareness and how you might detect those threats. There are more comprehensive lists available, but some examples include:

* Large outbound data transfers, especially to countries or systems the business should not be interacting with
* A user logged into an unusual number of systems. If John normally only logs into his workstation it would be concerning if his account were to suddenly log into every system in his department
* A user logged in at unusual times such as overnight or on the weekend
* A large number of failed logins which may indicate a brute force attack
* Alerts from security controls such as AV or IPS systems

For each of the above, consider the following questions:

* What log entries would be generated by the event and how would you single them out?
* How would you further research an event to determine if the activity is malicious? For example, a large outbound data transfer could be a data breach or it could be a Systems Administrator backing up data to an authorized cloud provider. How could you determine the difference?
* How might you leverage multiple sources to confirm an incident? For example if a system had a botnet client, what are all the security controls that might indicate its presence (think host based and network based).
* Given two incidents how would you prioritize which one to research first? Go back to the Risk discussion in the first post of this series
* Once you’ve got an incident it’s time to Respond, which is the subject of next week’s post.


